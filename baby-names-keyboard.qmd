---
title: "Visualizing the Most Popular Female Baby Names From 2003"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: install-devtools-keyboard
devtools::install_github("sharlagelfand/ggkeyboard", ref = "main")
```

```{r}
#| label: load-packages
#| message: false
library(tidyverse)
library(ggkeyboard) # https://github.com/sharlagelfand/ggkeyboard
library(scales)
```

#Task 1: Take the first letter from each baby name 

```{r}
#| label: load-data
names <- read_csv("https://raw.githubusercontent.com/hadley/data-baby-names/master/baby-names.csv")

```

```{r}
#| label: subset-2003-girls
female_03 <- names |>
  subset(year == "2003" & sex == "girl") |>
  mutate(first_letter = str_sub(name, start = 1, end = 1)) 

female_03_counts <- female_03 |>
    count(first_letter, sort = TRUE)
view(female_03_counts)
```

#Task 2: Draw a keyboard 

```{r}
#| label: keyboard-display
ggkeyboard(tkl, layout = "iso")
```

## Task 3: Color keyboard keys based on frequency of first letter

dark blue - "#2D669B"
light blue - "#359CA8"
green - "#B8C222"
yellow - "#EEDD49"
orange - "#F2BC4A"
dark orange - "#FB704A"
red - "#BE372C"

### Color scale

Need exploratory analysis to determine a scale based on the distribution of `n`.

```{r}
#| label: summary-stats
female_03_counts |>
  summarise(
    min = min(n),
    mean = mean(n),
    sd = sd(n),
    max = max(n),
    q20 = quantile(n, 0.20),
    q40 = quantile(n, 0.40),
    q60 = quantile(n, 0.60),
    q80 = quantile(n, 0.80)
  )
```

- dark blue   - "#2D669B" - 0
- light blue  - "#359CA8" - 5
- green       - "#B8C222" - 10
- yellow      - "#EEDD49" - 20
- orange      - "#F2BC4A" - 30
- dark orange - "#FB704A" - 60
- red         - "#BE372C" - > 100

Assigning colors to letters 

```{r}
female_03_counts <- female_03_counts |>
  mutate(
    color = case_when(
      n == 0                 ~ "#1d4877", #dark blue
      n <=  3                ~ "#1C5E6D", #green blue
      n > 3  & n <= 10      ~ "#1b8a5a", #green
      n > 10 & n <= 20      ~ "#B0A334", #yellow green
      n > 20 & n <= 30      ~ "#fbb021", #yellow
      n > 30 & n <= 60     ~ "#f68838", #orange
      n > 60 & n <=95     ~ "#ee3e32", #light red
      n > 95               ~ "#FF0000" #DARK red
      ),
    first_letter = str_to_upper(first_letter)
  ) |>
  arrange(first_letter)
view(female_03_counts)

```

```{r}
keys <- read_csv("https://raw.githubusercontent.com/sharlagelfand/ggkeyboard/061f0d9084d76d576200e81439311983e1d50d93/data-raw/sixty_percent.csv")
female_03_counts_ordered <- keys |>
  filter(key_label %in% LETTERS) |>
  select(key) |>
  left_join(female_03_counts, by = c("key" = "first_letter"))
view(female_03_counts_ordered)
```

```{r}
female_03_legend <- female_03_counts |>
  mutate(
    order = case_when(n <= 150 ~ 0),
    rank = dense_rank(desc(n))
  ) 
view(female_03_legend)

```


```{r}
ggplot(female_03_legend, aes(x = rank, y = order, fill = color)) +
  geom_tile("") +
  scale_fill_identity()
```


```{r}
keyboard_palette <- function(palette = c("heatmap")) {
  palette <- match.arg(palette)
    heatmap = c(
      background = "#FFFFFF",
      keyboard = "#3468E0",
      alphanumeric = "#3468E0",
      accent = "#3468E0",
      modifier = "#3468E0",
      numpad = "#3468E0",
      arrow = "#3468E0",
      light = "#FFFFFF",
      text = "#FFFFDC"
    )
}
```

```{r}

keyboard <- ggkeyboard(sixty_percent, palette = keyboard_palette("heatmap")) |>
  highlight_keys(
    keys = female_03_counts_ordered$key, 
    fill = female_03_counts_ordered$color, 
    alpha = 0.7, 
    colour = NA
    ) +
  labs(
    title = "Heat Map of Keyboard", 
    subtitle = "Most Common Female Baby Names in 2003 by First Letter",
    caption = "Dark Red: >60 | Light Red: 30-60 
              Dark Yellow: 10-20 | Light Yellow: 5-10 
              Dark Blue: 1-5 | Light Blue: 0"
  ) + 
  theme(
    text = element_text(
      size = 13,  
      family = "serif")
    )

keyboard
```

```{r}

```

